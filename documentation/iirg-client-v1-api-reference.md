# iIRS Attack Graph Generator (iRG) Client RestAPI Call Reference

**Version 1: 12/Oct/2019**

**Changelog**

| Date        | Description |
| ----------- | ----------- |
| 12/Oct/2019 | Document creation. |

## List of Endpoints

**The API of the Attack Graph Engine Client reaches server at :**\
`http://127.0.0.1:10000/ag-engine-server/rest/json` 

**Status field explanation:**\
:heavy_check_mark: = Completed\
:heavy_minus_sign: = In Development / Unfinished

| #  | Request Method | Endpoint | Description | Status |
| :-: | -------------: | -------- | ----------- | :----: |
| 1  | GET  | /topology | Get the provided/generated FIWARE XML topology. | :heavy_check_mark: |
| 2  | GET  | /host/list | Get the list of hosts and their security requirements. | :heavy_check_mark: |
| 3  | GET  | /attack_graph | Get the attack graph (as generated by MulVAL). | :heavy_check_mark: |
| 4  | GET  | /attack_graph/topological | Get the topological form of the attack graph. | :heavy_check_mark: |
| 5  | GET  | /attack_path/list | Get all attack paths. | :heavy_check_mark: |
| 6  | GET  | /attack_path/number | Get the number of attack paths. | :heavy_check_mark: | 
| 7  | GET  | /attack_path/{id} | Get the specified attack path. | :heavy_check_mark: | 
| 8  | GET  | /attack_path/{id}/topological | Get the topological form. | :heavy_check_mark: | 
| 9  | GET  | /attack_path/{id}/remediations | Get the remediations for the specified attack path. | :heavy_check_mark: |  
| 10 | GET  | /attack_path/{id}/remediation/{id_remediation} | Simulate the specified remediation on the specified attack path and compute the new attack graph. | :heavy_check_mark: |
| 11 | GET  | /attack_path/{id}/remediation/{id_remediation}/validate  | Validate that the specified remediation has been applied. | :heavy_check_mark: | 
| 12 | GET  | /firewall-rule | Get the firewall-rule. | :heavy_minus_sign: | 
| 13 | GET  | /patch | Get the patches. | :heavy_minus_sign: |
| 14 | POST | /initialize | Initialize using an already-generated FIWARE XML topology. | :heavy_check_mark: |

## Data Message Examples


### 1 - Get the provided/generated FIWARE XML topology.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/topology`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```xml
<topology>
  <machine>
    <name>pfsense</name>
    <cpe>cpe:/</cpe>
    <interfaces>
      <interface>
        <name>em0</name>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <ipaddress>10.0.10.1</ipaddress>
        <directly-connected>
          <ipaddress>10.0.10.110</ipaddress>
          <ipaddress>10.0.10.105</ipaddress>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>dnsmasq domain</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>TCP</protocol>
        <port>53</port>
        <CPE>cpe:/</CPE>
      </service>
      <service>
        <name>openssh ssh</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>TCP</protocol>
        <port>22</port>
        <CPE>cpe:/</CPE>
        <vulnerabilities>
          <vulnerability>
            <type>remoteExploit</type>
            <goal>privEscalation</goal>
            <cve>CVE-2018-15919</cve>
          </vulnerability>
          <vulnerability>
            <type>remoteExploit</type>
            <goal>privEscalation</goal>
            <cve>CVE-2017-15906</cve>
          </vulnerability>
        </vulnerabilities>
      </service>
      <service>
        <name>nginx http</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>TCP</protocol>
        <port>80</port>
        <CPE>cpe:/</CPE>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>em0</interface>
      </route>
      <route>
        <destination>10.0.10.0</destination>
        <mask>255.255.255.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>em0</interface>
      </route>
    </routes>
    <input-firewall>
      <default-policy>ACCEPT</default-policy>
    </input-firewall>
    <output-firewall>
      <default-policy>ACCEPT</default-policy>
    </output-firewall>
  </machine>
  <machine>
    <name>host-000C292272F2</name>
    <cpe>cpe:/</cpe>
    <interfaces>
      <interface>
        <name>fa0</name>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <ipaddress>10.0.10.110</ipaddress>
        <directly-connected>
          <ipaddress>10.0.10.1</ipaddress>
          <ipaddress>10.0.10.105</ipaddress>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services />
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>fa0</interface>
      </route>
    </routes>
    <input-firewall>
      <default-policy>ACCEPT</default-policy>
    </input-firewall>
    <output-firewall>
      <default-policy>ACCEPT</default-policy>
    </output-firewall>
  </machine>
  <machine>
    <name>host-000c29c5f1ce</name>
    <cpe>cpe:/</cpe>
    <interfaces>
      <interface>
        <name>fa0</name>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <ipaddress>10.0.10.105</ipaddress>
        <directly-connected>
          <ipaddress>10.0.10.1</ipaddress>
          <ipaddress>10.0.10.110</ipaddress>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>openssh ssh</name>
        <ipaddress>10.0.10.105</ipaddress>
        <protocol>TCP</protocol>
        <port>22</port>
        <CPE>cpe:/</CPE>
      </service>
      <service>
        <name>wsgiserver/0.2 cpython/3.6.8 http-alt</name>
        <ipaddress>10.0.10.105</ipaddress>
        <protocol>TCP</protocol>
        <port>8000</port>
        <CPE>cpe:/</CPE>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>fa0</interface>
      </route>
    </routes>
    <input-firewall>
      <default-policy>ACCEPT</default-policy>
    </input-firewall>
    <output-firewall>
      <default-policy>ACCEPT</default-policy>
    </output-firewall>
  </machine>
</topology>
```

</details>

---

### 2 - Get the list of hosts and their security requirements.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/host/list`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "hosts": [
        {
            "name": "pfsense",
            "security_requirements": [
                {
                    "metric": "Negligeable",
                    "name": "sec-req-xml"
                }
            ]
        },
        {
            "name": "host-000C292272F2",
            "security_requirements": [
                {
                    "metric": "Negligeable",
                    "name": "sec-req-xml"
                }
            ]
        },
        {
            "name": "host-000c29c5f1ce",
            "security_requirements": [
                {
                    "metric": "Negligeable",
                    "name": "sec-req-xml"
                }
            ]
        }
    ]
}
```

</details>

---



### 3 - Get the attack graph (as generated by MulVAL).
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_graph`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "attack_graph": {
        "arcs": {
            "arc": [
                {
                    "dst": 3,
                    "prob": 1,
                    "src": 2
                },
                {
                    "dst": 2,
                    "prob": 1,
                    "src": 1
                },
                {
                    "dst": 6,
                    "prob": 1,
                    "src": 5
                },
                {
                    "dst": 5,
                    "prob": 1,
                    "src": 4
                },
                {
                    "dst": 9,
                    "prob": 1,
                    "src": 8
                },
                {
                    "dst": 8,
                    "prob": 1,
                    "src": 7
                },
                {
                    "dst": 18,
                    "prob": 1,
                    "src": 17
                },
                {
                    "dst": 17,
                    "prob": 1,
                    "src": 16
                },
                {
                    "dst": 16,
                    "prob": 1,
                    "src": 15
                },
                {
                    "dst": 21,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 22,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 23,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 20,
                    "prob": 1,
                    "src": 19
                },
                {
                    "dst": 19,
                    "prob": 1,
                    "src": 15
                },
                {
                    "dst": 15,
                    "prob": 1,
                    "src": 14
                },
                {
                    "dst": 14,
                    "prob": 1,
                    "src": 13
                },
                {
                    "dst": 24,
                    "prob": 1,
                    "src": 13
                },
                {
                    "dst": 25,
                    "prob": 1,
                    "src": 13
                },
                {
                    "dst": 26,
                    "prob": 1,
                    "src": 13
                },
                {
                    "dst": 4,
                    "prob": 1,
                    "src": 13
                },
                {
                    "dst": 13,
                    "prob": 1,
                    "src": 12
                },
                {
                    "dst": 18,
                    "prob": 1,
                    "src": 31
                },
                {
                    "dst": 31,
                    "prob": 1,
                    "src": 30
                },
                {
                    "dst": 30,
                    "prob": 1,
                    "src": 29
                },
                {
                    "dst": 21,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 34,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 35,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 33,
                    "prob": 1,
                    "src": 32
                },
                {
                    "dst": 32,
                    "prob": 1,
                    "src": 29
                },
                {
                    "dst": 29,
                    "prob": 1,
                    "src": 28
                },
                {
                    "dst": 28,
                    "prob": 1,
                    "src": 27
                },
                {
                    "dst": 36,
                    "prob": 1,
                    "src": 27
                },
                {
                    "dst": 25,
                    "prob": 1,
                    "src": 27
                },
                {
                    "dst": 37,
                    "prob": 1,
                    "src": 27
                },
                {
                    "dst": 1,
                    "prob": 1,
                    "src": 27
                },
                {
                    "dst": 27,
                    "prob": 1,
                    "src": 12
                },
                {
                    "dst": 12,
                    "prob": 1,
                    "src": 11
                },
                {
                    "dst": 38,
                    "prob": 1,
                    "src": 11
                },
                {
                    "dst": 25,
                    "prob": 1,
                    "src": 11
                },
                {
                    "dst": 39,
                    "prob": 1,
                    "src": 11
                },
                {
                    "dst": 11,
                    "prob": 1,
                    "src": 10
                },
                {
                    "dst": 12,
                    "prob": 1,
                    "src": 40
                },
                {
                    "dst": 38,
                    "prob": 1,
                    "src": 40
                },
                {
                    "dst": 25,
                    "prob": 1,
                    "src": 40
                },
                {
                    "dst": 41,
                    "prob": 1,
                    "src": 40
                },
                {
                    "dst": 40,
                    "prob": 1,
                    "src": 10
                }
            ]
        },
        "vertices": {
            "vertex": [
                {
                    "fact": "execCode('host-000C292272F2',root)",
                    "id": 1,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "host-000C292272F2"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 2,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated('host-000C292272F2')",
                    "id": 3,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "host-000C292272F2"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "execCode('host-000c29c5f1ce',root)",
                    "id": 4,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "host-000c29c5f1ce"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 5,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated('host-000c29c5f1ce')",
                    "id": 6,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "host-000c29c5f1ce"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "execCode(pfsense,root)",
                    "id": 7,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 8,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated(pfsense)",
                    "id": 9,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "execCode(pfsense,user)",
                    "id": 10,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 1 (remote exploit of a server program)",
                    "id": 11,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "netAccess('10.0.10.1','TCP',22)",
                    "id": 12,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 2 (multi-hop access)",
                    "id": 13,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "hacl('10.0.10.105','10.0.10.1','TCP',22)",
                    "id": 14,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 8 (Access enabled between hosts in same vlan)",
                    "id": 15,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "RULE 12 (No local filtering on this host)",
                    "id": 17,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "localAccessEnabled('10.0.10.105','10.0.10.1',port)",
                    "id": 16,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "ipInSameVLAN('10.0.10.105','10.0.10.1')",
                    "id": 19,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "defaultLocalFilteringBehavior('10.0.10.1',allow)",
                    "id": 18,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "isInVlan('10.0.10.1','VLAN00')",
                    "id": 21,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 7 (Interfaces are in the same vlan)",
                    "id": 20,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "isInVlan('10.0.10.105','VLAN00')",
                    "id": 23,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "\\==('10.0.10.105','10.0.10.1')",
                    "id": 22,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "hasIP(pfsense,'10.0.10.1')",
                    "id": 25,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "\\==('host-000c29c5f1ce',pfsense)",
                    "id": 24,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 2 (multi-hop access)",
                    "id": 27,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "hasIP('host-000c29c5f1ce','10.0.10.105')",
                    "id": 26,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 8 (Access enabled between hosts in same vlan)",
                    "id": 29,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "hacl('10.0.10.110','10.0.10.1','TCP',22)",
                    "id": 28,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 12 (No local filtering on this host)",
                    "id": 31,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "localAccessEnabled('10.0.10.110','10.0.10.1',port)",
                    "id": 30,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "\\==('10.0.10.110','10.0.10.1')",
                    "id": 34,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "isInVlan('10.0.10.110','VLAN00')",
                    "id": 35,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "ipInSameVLAN('10.0.10.110','10.0.10.1')",
                    "id": 32,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "RULE 7 (Interfaces are in the same vlan)",
                    "id": 33,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "networkServiceInfo('10.0.10.1','openssh ssh','TCP',22,user)",
                    "id": 38,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "cpe": "cpe:/",
                        "hostname": "pfsense",
                        "ip": "10.0.10.1",
                        "port": 22,
                        "protocol": "TCP",
                        "service": "openssh ssh"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "vulExists(pfsense,'CVE-2017-15906','openssh ssh',remoteExploit,privEscalation)",
                    "id": 39,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "cpe": "cpe:/",
                        "hostname": "pfsense",
                        "ip": "10.0.10.1",
                        "port": 22,
                        "protocol": "TCP",
                        "service": "openssh ssh"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "\\==('host-000C292272F2',pfsense)",
                    "id": 36,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "hasIP('host-000C292272F2','10.0.10.110')",
                    "id": 37,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 1 (remote exploit of a server program)",
                    "id": 40,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "vulExists(pfsense,'CVE-2018-15919','openssh ssh',remoteExploit,privEscalation)",
                    "id": 41,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "cpe": "cpe:/",
                        "hostname": "pfsense",
                        "ip": "10.0.10.1",
                        "port": 22,
                        "protocol": "TCP",
                        "service": "openssh ssh"
                    },
                    "type": "LEAF"
                }
            ]
        }
    }
}
```

</details>

---


### 4 - Get the topological form of the attack graph.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_graph/topological`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "arcs": {
        "arc": [
            {
                "dst": 2,
                "label": "CVE-2017-15906",
                "src": 1
            },
            {
                "dst": 2,
                "label": "CVE-2017-15906",
                "src": 0
            }
        ]
    },
    "vertices": {
        "vertex": [
            {
                "compromised": false,
                "id": 0,
                "ip_addresses": [
                    "10.0.10.110"
                ],
                "name": "host-000C292272F2",
                "source_of_attack": true,
                "target": false,
                "type": "MACHINE"
            },
            {
                "compromised": false,
                "id": 1,
                "ip_addresses": [
                    "10.0.10.105"
                ],
                "name": "host-000c29c5f1ce",
                "source_of_attack": true,
                "target": false,
                "type": "MACHINE"
            },
            {
                "compromised": true,
                "id": 2,
                "ip_addresses": [
                    "10.0.10.1"
                ],
                "name": "pfsense",
                "source_of_attack": true,
                "target": false,
                "type": "MACHINE"
            }
        ]
    }
}
```

</details>

---


### 5 - Get all attack paths.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_path/list`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "attack_paths": {
        "attack_path": {
            "arcs": {
                "arc": [
                    {
                        "dst": 11,
                        "src": 10
                    },
                    {
                        "dst": 12,
                        "src": 11
                    },
                    {
                        "dst": 13,
                        "src": 12
                    },
                    {
                        "dst": 14,
                        "src": 13
                    },
                    {
                        "dst": 15,
                        "src": 14
                    },
                    {
                        "dst": 16,
                        "src": 15
                    },
                    {
                        "dst": 17,
                        "src": 16
                    },
                    {
                        "dst": 18,
                        "src": 17
                    },
                    {
                        "dst": 19,
                        "src": 15
                    },
                    {
                        "dst": 20,
                        "src": 19
                    },
                    {
                        "dst": 21,
                        "src": 20
                    },
                    {
                        "dst": 22,
                        "src": 20
                    },
                    {
                        "dst": 23,
                        "src": 20
                    },
                    {
                        "dst": 24,
                        "src": 13
                    },
                    {
                        "dst": 25,
                        "src": 13
                    },
                    {
                        "dst": 26,
                        "src": 13
                    },
                    {
                        "dst": 4,
                        "src": 13
                    },
                    {
                        "dst": 5,
                        "src": 4
                    },
                    {
                        "dst": 6,
                        "src": 5
                    },
                    {
                        "dst": 27,
                        "src": 12
                    },
                    {
                        "dst": 28,
                        "src": 27
                    },
                    {
                        "dst": 29,
                        "src": 28
                    },
                    {
                        "dst": 30,
                        "src": 29
                    },
                    {
                        "dst": 31,
                        "src": 30
                    },
                    {
                        "dst": 18,
                        "src": 31
                    },
                    {
                        "dst": 32,
                        "src": 29
                    },
                    {
                        "dst": 33,
                        "src": 32
                    },
                    {
                        "dst": 21,
                        "src": 33
                    },
                    {
                        "dst": 34,
                        "src": 33
                    },
                    {
                        "dst": 35,
                        "src": 33
                    },
                    {
                        "dst": 36,
                        "src": 27
                    },
                    {
                        "dst": 25,
                        "src": 27
                    },
                    {
                        "dst": 37,
                        "src": 27
                    },
                    {
                        "dst": 1,
                        "src": 27
                    },
                    {
                        "dst": 2,
                        "src": 1
                    },
                    {
                        "dst": 3,
                        "src": 2
                    },
                    {
                        "dst": 38,
                        "src": 11
                    },
                    {
                        "dst": 25,
                        "src": 11
                    },
                    {
                        "dst": 39,
                        "src": 11
                    },
                    {
                        "dst": 40,
                        "src": 10
                    },
                    {
                        "dst": 12,
                        "src": 40
                    },
                    {
                        "dst": 38,
                        "src": 40
                    },
                    {
                        "dst": 25,
                        "src": 40
                    },
                    {
                        "dst": 41,
                        "src": 40
                    }
                ]
            },
            "scoring": 0.08881578947368421
        }
    }
}
```

</details>

---

### 6 - Get the number of attack paths.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_path/number`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "number": 1
}
```

</details>

---

### 7 - Get the specified attack path.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_path/{id}`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "attack_path": {
        "arcs": {
            "arc": [
                {
                    "dst": 11,
                    "src": 10
                },
                {
                    "dst": 12,
                    "src": 11
                },
                {
                    "dst": 13,
                    "src": 12
                },
                {
                    "dst": 14,
                    "src": 13
                },
                {
                    "dst": 15,
                    "src": 14
                },
                {
                    "dst": 16,
                    "src": 15
                },
                {
                    "dst": 17,
                    "src": 16
                },
                {
                    "dst": 18,
                    "src": 17
                },
                {
                    "dst": 19,
                    "src": 15
                },
                {
                    "dst": 20,
                    "src": 19
                },
                {
                    "dst": 21,
                    "src": 20
                },
                {
                    "dst": 22,
                    "src": 20
                },
                {
                    "dst": 23,
                    "src": 20
                },
                {
                    "dst": 24,
                    "src": 13
                },
                {
                    "dst": 25,
                    "src": 13
                },
                {
                    "dst": 26,
                    "src": 13
                },
                {
                    "dst": 4,
                    "src": 13
                },
                {
                    "dst": 5,
                    "src": 4
                },
                {
                    "dst": 6,
                    "src": 5
                },
                {
                    "dst": 27,
                    "src": 12
                },
                {
                    "dst": 28,
                    "src": 27
                },
                {
                    "dst": 29,
                    "src": 28
                },
                {
                    "dst": 30,
                    "src": 29
                },
                {
                    "dst": 31,
                    "src": 30
                },
                {
                    "dst": 18,
                    "src": 31
                },
                {
                    "dst": 32,
                    "src": 29
                },
                {
                    "dst": 33,
                    "src": 32
                },
                {
                    "dst": 21,
                    "src": 33
                },
                {
                    "dst": 34,
                    "src": 33
                },
                {
                    "dst": 35,
                    "src": 33
                },
                {
                    "dst": 36,
                    "src": 27
                },
                {
                    "dst": 25,
                    "src": 27
                },
                {
                    "dst": 37,
                    "src": 27
                },
                {
                    "dst": 1,
                    "src": 27
                },
                {
                    "dst": 2,
                    "src": 1
                },
                {
                    "dst": 3,
                    "src": 2
                },
                {
                    "dst": 38,
                    "src": 11
                },
                {
                    "dst": 25,
                    "src": 11
                },
                {
                    "dst": 39,
                    "src": 11
                },
                {
                    "dst": 40,
                    "src": 10
                },
                {
                    "dst": 12,
                    "src": 40
                },
                {
                    "dst": 38,
                    "src": 40
                },
                {
                    "dst": 25,
                    "src": 40
                },
                {
                    "dst": 41,
                    "src": 40
                }
            ]
        },
        "scoring": 0.08881578947368421
    }
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The attack path 1 does not exist. There are only1 attack paths (0 to 0)"
}
```

</details>

---

### 8 - Same as above but in its topological form.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/json/attack_path/{id}/topological`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "arcs": {
        "arc": [
            {
                "dst": 2,
                "label": "CVE-2017-15906",
                "src": 1
            },
            {
                "dst": 2,
                "label": "CVE-2017-15906",
                "src": 0
            }
        ]
    },
    "vertices": {
        "vertex": [
            {
                "compromised": false,
                "id": 0,
                "ip_addresses": [
                    "10.0.10.110"
                ],
                "name": "host-000C292272F2",
                "source_of_attack": true,
                "target": false,
                "type": "MACHINE"
            },
            {
                "compromised": false,
                "id": 1,
                "ip_addresses": [
                    "10.0.10.105"
                ],
                "name": "host-000c29c5f1ce",
                "source_of_attack": true,
                "target": false,
                "type": "MACHINE"
            },
            {
                "compromised": true,
                "id": 2,
                "ip_addresses": [
                    "10.0.10.1"
                ],
                "name": "pfsense",
                "source_of_attack": false,
                "target": true,
                "type": "MACHINE"
            }
        ]
    }
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The attack path 1 does not exist. There are only1 attack paths (0 to 0)"
}
```

</details>

---

### 9 - Get the remediations for the specified attack path.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/attack_path/{id}/remediations`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "remediations": {
        "remediation": [
            {
                "cost": 0,
                "habit_index": 0,
                "remediation_actions": {
                    "deployable_remediation": [
                        {
                            "action": {
                                "rule": "iptables -I INPUT -s 10.0.10.110/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "pfsense"
                        },
                        {
                            "action": {
                                "rule": "iptables -I INPUT -s 10.0.10.105/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "pfsense"
                        }
                    ]
                }
            },
            {
                "cost": 0,
                "habit_index": 0,
                "remediation_actions": {
                    "deployable_remediation": [
                        {
                            "action": {
                                "rule": "iptables -I OUTPUT -s 10.0.10.110/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "host-000C292272F2"
                        },
                        {
                            "action": {
                                "rule": "iptables -I INPUT -s 10.0.10.105/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "pfsense"
                        }
                    ]
                }
            },
            {
                "cost": 0,
                "habit_index": 0,
                "remediation_actions": {
                    "deployable_remediation": [
                        {
                            "action": {
                                "rule": "iptables -I INPUT -s 10.0.10.110/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "pfsense"
                        },
                        {
                            "action": {
                                "rule": "iptables -I OUTPUT -s 10.0.10.105/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "host-000c29c5f1ce"
                        }
                    ]
                }
            },
            {
                "cost": 0,
                "habit_index": 0,
                "remediation_actions": {
                    "deployable_remediation": [
                        {
                            "action": {
                                "rule": "iptables -I OUTPUT -s 10.0.10.110/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "host-000C292272F2"
                        },
                        {
                            "action": {
                                "rule": "iptables -I OUTPUT -s 10.0.10.105/32 -d 10.0.10.1/32 -p TCP  --dport 22:22  -j DROP",
                                "type": "firewall-rule"
                            },
                            "machine": "host-000c29c5f1ce"
                        }
                    ]
                }
            }
        ]
    }
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The attack path 1 does not exist. There are only1 attack paths (0 to 0)"
}
```

</details>

---

### 10 - Simulate the specified remediation on the specified attack path and compute the new attack graph.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/attack_path/{id}/remediation/{id_remediation}`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "attack_graph": {
        "arcs": {
            "arc": [
                {
                    "dst": 3,
                    "prob": 1,
                    "src": 2
                },
                {
                    "dst": 2,
                    "prob": 1,
                    "src": 1
                },
                {
                    "dst": 6,
                    "prob": 1,
                    "src": 5
                },
                {
                    "dst": 5,
                    "prob": 1,
                    "src": 4
                },
                {
                    "dst": 9,
                    "prob": 1,
                    "src": 8
                },
                {
                    "dst": 8,
                    "prob": 1,
                    "src": 7
                },
                {
                    "dst": 18,
                    "prob": 1,
                    "src": 17
                },
                {
                    "dst": 17,
                    "prob": 1,
                    "src": 16
                },
                {
                    "dst": 16,
                    "prob": 1,
                    "src": 15
                },
                {
                    "dst": 21,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 22,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 23,
                    "prob": 1,
                    "src": 20
                },
                {
                    "dst": 20,
                    "prob": 1,
                    "src": 19
                },
                {
                    "dst": 19,
                    "prob": 1,
                    "src": 15
                },
                {
                    "dst": 18,
                    "prob": 1,
                    "src": 31
                },
                {
                    "dst": 31,
                    "prob": 1,
                    "src": 30
                },
                {
                    "dst": 30,
                    "prob": 1,
                    "src": 29
                },
                {
                    "dst": 21,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 34,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 35,
                    "prob": 1,
                    "src": 33
                },
                {
                    "dst": 33,
                    "prob": 1,
                    "src": 32
                },
                {
                    "dst": 32,
                    "prob": 1,
                    "src": 29
                }
            ]
        },
        "vertices": {
            "vertex": [
                {
                    "fact": "execCode('host-000C292272F2',root)",
                    "id": 1,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "host-000C292272F2"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 2,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated('host-000C292272F2')",
                    "id": 3,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "host-000C292272F2"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "execCode('host-000c29c5f1ce',root)",
                    "id": 4,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "host-000c29c5f1ce"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 5,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated('host-000c29c5f1ce')",
                    "id": 6,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "host-000c29c5f1ce"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "execCode(pfsense,root)",
                    "id": 7,
                    "init_risk": 1,
                    "metric": 0,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "OR"
                },
                {
                    "fact": "RULE 3 (Attacker is root on his machine)",
                    "id": 8,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "attackerLocated(pfsense)",
                    "id": 9,
                    "init_risk": 1,
                    "metric": 1,
                    "related_host": {
                        "hostname": "pfsense"
                    },
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 8 (Access enabled between hosts in same vlan)",
                    "id": 15,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "RULE 12 (No local filtering on this host)",
                    "id": 17,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "localAccessEnabled('10.0.10.105','10.0.10.1',port)",
                    "id": 16,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "ipInSameVLAN('10.0.10.105','10.0.10.1')",
                    "id": 19,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "defaultLocalFilteringBehavior('10.0.10.1',allow)",
                    "id": 18,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "isInVlan('10.0.10.1','VLAN00')",
                    "id": 21,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 7 (Interfaces are in the same vlan)",
                    "id": 20,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "isInVlan('10.0.10.105','VLAN00')",
                    "id": 23,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "\\==('10.0.10.105','10.0.10.1')",
                    "id": 22,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "RULE 8 (Access enabled between hosts in same vlan)",
                    "id": 29,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "RULE 12 (No local filtering on this host)",
                    "id": 31,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                },
                {
                    "fact": "localAccessEnabled('10.0.10.110','10.0.10.1',port)",
                    "id": 30,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "\\==('10.0.10.110','10.0.10.1')",
                    "id": 34,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "isInVlan('10.0.10.110','VLAN00')",
                    "id": 35,
                    "init_risk": 1,
                    "metric": 1,
                    "type": "LEAF"
                },
                {
                    "fact": "ipInSameVLAN('10.0.10.110','10.0.10.1')",
                    "id": 32,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "OR"
                },
                {
                    "fact": "RULE 7 (Interfaces are in the same vlan)",
                    "id": 33,
                    "init_risk": 1,
                    "metric": 0,
                    "type": "AND"
                }
            ]
        }
    }
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The attack path 1 does not exist. There are only1 attack paths (0 to 0)"
}
```

</details>
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The remediation 4 does not exist. There are only4 remediations (0 to 3)"
}
```

</details>

---

### 11 - Validate that the specified remediation has been applied.
**GET:** `http://127.0.0.1:10000/ag-engine-server/rest/attack_path/{id}/remediation/{id_remediation}/validate`

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "success": "[INFO] The remediation has been validated."
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The attack path 1 does not exist. There are only1 attack paths (0 to 0)"
}
```

</details>
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The remediation 4 does not exist. There are only4 remediations (0 to 3)"
}
```

</details>

---

### 14 - Initialize using an already-generated XML topology.
**POST:** `http://127.0.0.1:10000/ag-engine-server/rest/json/initialize`

**Request Data:**
<details>
<summary>Click to collapse/fold.</summary>

```xml
<topology>
  <machine>
    <name>pfsense</name>
    <security_requirement>1</security_requirement>
    <interfaces>
      <interface>
        <name>em0</name>
        <ipaddress>10.0.10.1</ipaddress>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <directly-connected>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>openssh ssh</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>tcp</protocol>
        <port>22</port>
        <vulnerabilities>
          <vulnerability>
            <type>remoteExploit</type>
            <cve>CVE-2018-15919</cve>
            <goal>privEscalation</goal>
            <cvss>5.0</cvss>
          </vulnerability>
          <vulnerability>
            <type>remoteExploit</type>
            <cve>CVE-2017-15906</cve>
            <goal>privEscalation</goal>
            <cvss>5.0</cvss>
          </vulnerability>
        </vulnerabilities>
      </service>
      <service>
        <name>nginx http</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>tcp</protocol>
        <port>80</port>
      </service>
      <service>
        <name>dnsmasq domain</name>
        <ipaddress>10.0.10.1</ipaddress>
        <protocol>tcp</protocol>
        <port>53</port>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>em0</interface>
      </route>
      <route>
        <destination>10.0.10.0</destination>
        <mask>255.255.255.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>em0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host-000C292272F2</name>
    <security_requirement>1</security_requirement>
    <interfaces>
      <interface>
        <name>fa0</name>
        <ipaddress>10.0.10.110</ipaddress>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <directly-connected>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services />
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>fa0</interface>
      </route>
    </routes>
  </machine>
  <machine>
    <name>host-000c29c5f1ce</name>
    <security_requirement>1</security_requirement>
    <interfaces>
      <interface>
        <name>fa0</name>
        <ipaddress>10.0.10.105</ipaddress>
        <vlan>
          <name>VLAN00</name>
          <label>VLAN00</label>
        </vlan>
        <directly-connected>
          <internet />
        </directly-connected>
      </interface>
    </interfaces>
    <services>
      <service>
        <name>wsgiserver/0.2 cpython/3.6.8 http-alt</name>
        <ipaddress>10.0.10.105</ipaddress>
        <protocol>tcp</protocol>
        <port>8000</port>
      </service>
      <service>
        <name>openssh ssh</name>
        <ipaddress>10.0.10.105</ipaddress>
        <protocol>tcp</protocol>
        <port>22</port>
      </service>
    </services>
    <routes>
      <route>
        <destination>0.0.0.0</destination>
        <mask>0.0.0.0</mask>
        <gateway>10.0.10.1</gateway>
        <interface>fa0</interface>
      </route>
    </routes>
  </machine>
  <flow-matrix>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>35009</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>35009</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>48220</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>40709</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination resource="10.0.10.1" type="IP" />
      <source_port>40178</source_port>
      <destination_port>9594</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>48220</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>40709</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>36490</source_port>
      <destination_port>443</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>443</source_port>
      <destination_port>36490</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>42440</source_port>
      <destination_port>443</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>443</source_port>
      <destination_port>42440</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>55203</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>55203</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>60257</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>37226</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>37226</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>60257</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>45144</source_port>
      <destination_port>443</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>443</source_port>
      <destination_port>45144</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>41150</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>41150</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>60720</source_port>
      <destination_port>80</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>80</source_port>
      <destination_port>60720</destination_port>
      <protocol>TCP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source type="INTERNET" />
      <destination resource="10.0.10.105" type="IP" />
      <source_port>53</source_port>
      <destination_port>55697</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
    <flow-matrix-line>
      <source resource="10.0.10.105" type="IP" />
      <destination type="INTERNET" />
      <source_port>55697</source_port>
      <destination_port>53</destination_port>
      <protocol>UDP</protocol>
    </flow-matrix-line>
  </flow-matrix>
</topology>
```

</details>

**Response:**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "status": "Loaded"
}
```

</details>

**Error Response(s):**
<details>
<summary>Click to collapse/fold.</summary>

```json
{
    "error": "[ERROR] The file is not an XML file"
}
```

</details>
---
